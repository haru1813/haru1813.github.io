<script setup>
import ArticleHeader from '@/components/ArticleHeader.vue'
import ArticleBody from '@/components/ArticleBody.vue'

const post = {
  id: "springboot-request-response",
  title: "Spring Boot 요청·응답 데이터 주고받기 완전 정리",
  date: "2026-02-11",
  summary: "HttpServletRequest, ResponseEntity, HttpEntity, Model, MultipartFile, 스트리밍, SSE 등 Spring Boot(Spring MVC)에서 요청 데이터를 받고 응답을 만드는 다양한 방식을 정리합니다.",
  category: "Technology/SpringBoot",
  tags: ["springboot","http","request","response","backend"],
  content: ["## Spring Boot에서 데이터 주고받기 개요", "Spring MVC/Spring Boot는 요청 파라미터, 바디, 헤더, 파일 등 다양한 형태의 데이터를 받고, JSON·뷰·스트리밍 등으로 응답할 수 있는 여러 방법을 제공합니다. 용도별로 정리합니다.", "", "## 1) Servlet API 직접 사용", "", "### HttpServletRequest, HttpServletResponse", "가장 저수준 접근. 헤더, 쿠키, 세션, 스트림 등 전체 제어가 필요할 때 사용합니다.", "", "```java", "@GetMapping(\"/raw\")", "public void rawEndpoint(HttpServletRequest request, HttpServletResponse response)", "        throws IOException {", "    String userAgent = request.getHeader(\"User-Agent\");", "    String query = request.getQueryString();", "    String remoteAddr = request.getRemoteAddr();", "", "    response.setContentType(\"application/json\");", "    response.setCharacterEncoding(\"UTF-8\");", "    response.setStatus(200);", "    response.getWriter().write(\"{\\\"ok\\\":true}\");", "}", "```", "", "### @RequestHeader, @CookieValue", "특정 헤더·쿠키만 필요한 경우 파라미터로 주입합니다.", "", "```java", "@GetMapping", "public List<User> list(", "    @RequestHeader(\"X-Request-Id\") String requestId,", "    @RequestHeader(value = \"Accept-Language\", defaultValue = \"ko\") String lang,", "    @CookieValue(value = \"sessionId\", required = false) String sessionId) {", "    return userService.findAll();", "}", "```", "", "## 2) ResponseEntity - 응답 세밀 제어", "상태 코드, 헤더, 바디를 한 번에 제어할 때 사용합니다.", "", "```java", "@GetMapping(\"/{id}\")", "public ResponseEntity<UserResponse> get(@PathVariable Long id) {", "    return userService.findById(id)", "        .map(user -> ResponseEntity.ok()", "            .header(\"X-Custom\", \"value\")", "            .cacheControl(CacheControl.maxAge(60, TimeUnit.SECONDS))", "            .body(toResponse(user)))", "        .orElse(ResponseEntity.notFound().build());", "}", "", "@PostMapping", "public ResponseEntity<UserResponse> create(@Valid @RequestBody CreateUserRequest req) {", "    UserResponse created = userService.create(req);", "    return ResponseEntity", "        .created(URI.create(\"/api/users/\" + created.id()))", "        .body(created);", "}", "", "// 헤더만, 바디 없음", "@DeleteMapping(\"/{id}\")", "public ResponseEntity<Void> delete(@PathVariable Long id) {", "    userService.delete(id);", "    return ResponseEntity.noContent().build();", "}", "```", "", "## 3) HttpEntity, RequestEntity", "요청·응답을 바디 + 헤더로 래핑할 때 사용합니다.", "", "```java", "// HttpEntity: 요청 바디 + 헤더 접근", "@PostMapping(\"/with-headers\")", "public ResponseEntity<String> withHeaders(HttpEntity<CreateUserRequest> entity) {", "    HttpHeaders headers = entity.getHeaders();", "    CreateUserRequest body = entity.getBody();", "    String auth = headers.getFirst(\"Authorization\");", "    // ...", "    return ResponseEntity.ok(\"created\");", "}", "", "// RequestEntity: HttpMethod + URI 포함", "@GetMapping", "public ResponseEntity<List<User>> list(RequestEntity<Void> request) {", "    HttpMethod method = request.getMethod();", "    URI url = request.getUrl();", "    return ResponseEntity.ok(userService.findAll());", "}", "```", "", "## 4) @RequestBody, @ResponseBody, 반환 타입", "| 방식 | 설명 |", "|------|------|", "| @RequestBody | 요청 바디(JSON 등) → 객체 바인딩 |", "| @ResponseBody | 반환 객체 → 응답 바디로 직렬화 |", "| @RestController | 컨트롤러 전체에 @ResponseBody 적용 |", "| 반환 타입 | `User` 반환 시 Jackson이 JSON으로 변환 |", "", "```java", "@PostMapping", "public UserResponse create(@RequestBody CreateUserRequest req) {", "    return userService.create(req);", "}", "", "// Content-Type, Accept에 따라 메시지 컨버터가 선택됨(JSON, XML 등)", "```", "", "## 5) Model, ModelAndView (뷰 렌더링)", "서버 사이드 렌더링(Thymeleaf, JSP 등)에서 뷰에 데이터를 전달할 때 사용합니다.", "", "```java", "@Controller", "@RequestMapping(\"/pages\")", "public class PageController {", "    @GetMapping(\"/user/{id}\")", "    public String userPage(@PathVariable Long id, Model model) {", "        User user = userService.findById(id).orElseThrow();", "        model.addAttribute(\"user\", user);", "        return \"user-detail\";  // user-detail.html로 포워딩", "    }", "", "    @GetMapping(\"/list\")", "    public ModelAndView list() {", "        ModelAndView mav = new ModelAndView(\"user-list\");", "        mav.addObject(\"users\", userService.findAll());", "        return mav;", "    }", "}", "```", "", "## 6) RedirectAttributes (리다이렉트 시 데이터 전달)", "POST-Redirect-GET 패턴에서 한 번만 쓰일 데이터(플래시 메시지 등)를 전달합니다.", "", "```java", "@PostMapping(\"/create\")", "public String create(@Valid CreateUserRequest req, RedirectAttributes ra) {", "    User user = userService.create(req);", "    ra.addFlashAttribute(\"message\", \"회원가입 완료\");", "    ra.addAttribute(\"id\", user.getId());  // URL 쿼리로 전달", "    return \"redirect:/users/{id}\";", "}", "```", "", "## 7) MultipartFile (파일 업로드)", "`multipart/form-data` 형식의 파일 업로드를 처리합니다.", "", "```java", "@PostMapping(value = \"/upload\", consumes = MediaType.MULTIPART_FORM_DATA_VALUE)", "public ResponseEntity<UploadResponse> upload(", "    @RequestParam(\"file\") MultipartFile file,", "    @RequestParam(value = \"description\", required = false) String desc) {", "    if (file.isEmpty()) {", "        return ResponseEntity.badRequest().build();", "    }", "    String savedPath = fileService.save(file);", "    return ResponseEntity.ok(new UploadResponse(savedPath, file.getOriginalFilename()));", "}", "", "// 여러 파일", "@PostMapping(\"/upload-multi\")", "public ResponseEntity<?> uploadMulti(@RequestParam(\"files\") MultipartFile[] files) {", "    for (MultipartFile f : files) {", "        fileService.save(f);", "    }", "    return ResponseEntity.ok().build();", "}", "```", "", "## 8) 스트리밍 응답 (대용량·실시간)", "", "### StreamingResponseBody", "대용량 바이트를 메모리에 올리지 않고 스트리밍으로 응답할 때 사용합니다.", "", "```java", "@GetMapping(value = \"/download\", produces = MediaType.APPLICATION_OCTET_STREAM_VALUE)", "public ResponseEntity<StreamingResponseBody> download(@RequestParam String path) {", "    StreamingResponseBody stream = outputStream -> {", "        try (InputStream in = fileService.openStream(path)) {", "            in.transferTo(outputStream);", "        }", "    };", "    return ResponseEntity.ok()", "        .header(HttpHeaders.CONTENT_DISPOSITION, \"attachment; filename=report.csv\")", "        .body(stream);", "}", "```", "", "### Resource", "정적 파일·클래스패스 리소스를 응답할 때 사용합니다.", "", "```java", "@GetMapping(\"/file/{filename}\")", "public ResponseEntity<Resource> serveFile(@PathVariable String filename) {", "    Resource resource = fileService.loadAsResource(filename);", "    return ResponseEntity.ok()", "        .header(HttpHeaders.CONTENT_DISPOSITION,", "            \"attachment; filename=\\\"\" + filename + \"\\\"\")", "        .body(resource);", "}", "```", "", "## 9) Server-Sent Events (SSE)", "서버에서 클라이언트로 단방향 이벤트 스트리밍을 할 때 사용합니다.", "", "```java", "@GetMapping(value = \"/events\", produces = MediaType.TEXT_EVENT_STREAM_VALUE)", "public SseEmitter streamEvents() {", "    SseEmitter emitter = new SseEmitter(30_000L);", "    eventService.register(emitter);", "    emitter.onCompletion(() -> eventService.unregister(emitter));", "    emitter.onTimeout(() -> eventService.unregister(emitter));", "    return emitter;", "}", "", "// 이벤트 발행", "emitter.send(SseEmitter.event()", "    .name(\"message\")", "    .data(\"hello\"));", "```", "", "## 10) 요청 파라미터 vs 바디 정리", "| 구분 | 받는 쪽 | 용도 |", "|------|---------|------|", "| 쿼리(?key=val) | @RequestParam | GET, 조회 조건 |", "| 경로(/users/1) | @PathVariable | 리소스 식별자 |", "| 요청 바디(JSON) | @RequestBody | POST, PUT, PATCH 바디 |", "| 폼 데이터 | @RequestParam 또는 @ModelAttribute | form submit |", "| multipart | @RequestParam + MultipartFile | 파일 업로드 |", "", "## 11) 응답 형태별 선택 가이드", "| 상황 | 추천 방식 |", "|------|-----------|", "| 단순 객체 반환, 200 기본 | 반환 타입만 지정 |", "| 상태코드·헤더 제어 | ResponseEntity |", "| 대용량 파일 스트리밍 | StreamingResponseBody |", "| 정적/리소스 파일 | Resource |", "| 서버→클라이언트 실시간 | SseEmitter |", "| 뷰에 데이터 전달 | Model / ModelAndView |", "", "## 정리", "Spring Boot는 HttpServletRequest/Response 직접 사용부터 ResponseEntity, @RequestBody, MultipartFile, StreamingResponseBody, SseEmitter까지 요청·응답 데이터를 다루는 방법이 다양합니다. REST API는 보통 @RequestBody + ResponseEntity 조합으로 처리하고, 파일·스트리밍·SSE가 필요할 때 해당 방식으로 확장하면 됩니다."]
}
</script>

<template>
  <ArticleHeader :post="post" />
  <ArticleBody :content="post.content" />
</template>
